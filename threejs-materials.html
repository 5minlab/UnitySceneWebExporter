<!doctype html>

<html>
<head>
<title>Unity Scene Web Exporter</title>

<meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">

<meta name="viewport" content="width=device-width, initial-scale=1">

<!--
<link rel="stylesheet" href="./node_modules/purecss/build/pure-min.css">
-->
<link rel="stylesheet" href="./libs/pure-min.css">
<link rel="stylesheet" href="./index.css">


<!-- scripts -->
<!--
<script src="./node_modules/three/build/three.js"></script>
<script src="./node_modules/three/examples/js/libs/stats.min.js"></script>
-->
<script src="./libs/three.min.js"></script>
<script src="./libs/stats.min.js"></script>

<script src="./kanau-utils.js"></script>
</head>

<body>

<h1><a class="anchor-no-decoration" href="/">Unity Scene Web Exporter</a></h1>

<!-- github ribbon -->
<a href="https://github.com/5minlab/unity-scene-web-exporter"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>

<h3>Three.js Examples</h3>
<ul>
    <li><a class="anchor-no-decoration" href="./threejs-simple-scene.html">Simple Scene</a></li>
    <li><a class="anchor-no-decoration" href="./threejs-models.html">Models</a></li>
    <li><a class="anchor-no-decoration" href="./threejs-materials.html">Materials</a></li>
    <li><a class="anchor-no-decoration" href="./threejs-script-variables.html">Script Variables (see consoles)</a></li>
</ul>


<div id="container"></div>

<footer>
<a class="anchor-no-decoration" href="http://5minlab.com">© 2016 5minlab</a>
</footer>

<!-- Google Analytics: change UA-XXXXX-Y to be your site's ID. -->
<script>
    window.ga=function(){ga.q.push(arguments)};ga.q=[];ga.l=+new Date;
    ga('create','UA-66505862-1','auto');ga('send','pageview')
</script>
<script src="https://www.google-analytics.com/analytics.js" async defer></script>


<!-- three.js -->
<script>
var camera, scene, renderer;
var stats;


function setupScene(result) {
    scene = result;

    camera = findByUserData(scene, "tag", "MainCamera");
    // aspect는 threejs의 화면 크기로 계산하기
    var winsize = renderer.getSize();
    camera.aspect = winsize.width / winsize.height;
    camera.updateProjectionMatrix();

    // for script variables demo
    var scriptobj = findByUserData(scene, "tag", "Player");
    if(scriptobj) {
        funcForScriptVariables(scriptobj);
    }
}

function funcForScriptVariables(scriptobj) {
    for(var key in scriptobj.userData) {
        if(typeof(scriptobj.userData[key]) != "object") {
            continue;
        }
        for(var k in scriptobj.userData[key]) {
            console.log(key + ":" + JSON.stringify(scriptobj.userData[key][k]));
        }
    }
}

function init() {
    var container = document.getElementById('container');

    // stats
    stats = new Stats();
    stats.showPanel(0); // 0: fps, 1: ms, 2: mb, 3+: custom
    container.appendChild( stats.dom );

    // three.js
    renderer = new THREE.WebGLRenderer( { antialias: true } );
    renderer.setClearColor( 0x333333 );
    renderer.setPixelRatio( window.devicePixelRatio );
    renderer.setSize( 800, 480 );
    container.appendChild( renderer.domElement );
    

    // loade scene
    var loader = new THREE.ObjectLoader();
    var url = './samples/materials/scene.json';
    loader.load(url, function(obj) {
        setupScene(obj);
    });
};

function onWindowResize() {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize( window.innerWidth, window.innerHeight );
    render();
}

function animate() {
    stats.begin();
    if(scene && camera) {
        renderer.render(scene, camera);
    }
    stats.end();

    requestAnimationFrame( animate );
}

init();
requestAnimationFrame(animate);
</script>

</body>
</html>